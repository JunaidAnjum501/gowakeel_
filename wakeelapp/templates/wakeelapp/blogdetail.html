{% extends "wakeelapp/faq.html" %} {% load static %}
{% block title %}<title>{{ blog.title }} - GoWakeel</title>{% endblock title %}
{% block metatitle %}<meta name="description" content="{{ blog.content|slice:':160' }}">{% endblock metatitle %}

{% block Content %}
<section class="py-12 bg-gradient-to-r from-white to-[#003366]/5">
    <div class="max-w-7xl mx-auto px-6">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Main Blog Content -->
            <div class="w-full lg:w-2/3">
                <div class="bg-white rounded-xl shadow-md overflow-hidden border border-[#003366]/10 fade-in">
                    <!-- Blog Header -->
                    <div class="relative">
                        <div class="w-full h-[400px] overflow-hidden">
                            <img src="{{ blogs.image.url }}" alt="{{ blogs.title }}" class="w-full h-full object-cover" />
                        </div>
                        <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/70 to-transparent p-6">
                            <div class="flex items-center mb-2">
                                <span class="bg-[#003366] text-white text-xs font-medium px-2.5 py-0.5 rounded-full">
                                    {{ blog.category.name }}
                                </span>
                                <span class="text-white/90 text-xs ml-3">
                                    <i class="far fa-calendar-alt mr-1"></i> {{ blogs.created_at|date:"F d, Y" }}
                                </span>
                            </div>
                            <h1 class="text-3xl font-bold text-white mb-2">{{ blogs.title }}</h1>
                        </div>
                    </div>
                    
                    <!-- Blog Content -->
                    <div class="p-8">
                        <!-- Author Info -->
                        <div class="flex items-center mb-6 pb-6 border-b border-gray-200">
                            <div class="w-12 h-12 bg-[#003366] rounded-full flex items-center justify-center text-white text-xl font-bold mr-4">
                                GW
                            </div>
                            <div>
                                <h3 class="font-semibold text-[#003366]">GoWakeel Team</h3>
                                <p class="text-gray-500 text-sm">Tax & Business Experts</p>
                            </div>
                            <div class="ml-auto flex space-x-3">
                                <button onclick="sharePost('{{ blog.title }}', window.location.href)" class="w-8 h-8 bg-[#003366]/10 rounded-full flex items-center justify-center text-[#003366] hover:bg-[#003366] hover:text-white transition-colors">
                                    <i class="fas fa-share-alt"></i>
                                </button>
                                <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" class="w-8 h-8 bg-[#1877F2]/10 rounded-full flex items-center justify-center text-[#1877F2] hover:bg-[#1877F2] hover:text-white transition-colors">
                                    <i class="fab fa-facebook-f"></i>
                                </a>
                                <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ blog.title }}" target="_blank" class="w-8 h-8 bg-[#1DA1F2]/10 rounded-full flex items-center justify-center text-[#1DA1F2] hover:bg-[#1DA1F2] hover:text-white transition-colors">
                                    <i class="fab fa-twitter"></i>
                                </a>
                                <a href="https://wa.me/?text={{ blog.title }} {{ request.build_absolute_uri }}" target="_blank" class="w-8 h-8 bg-[#25D366]/10 rounded-full flex items-center justify-center text-[#25D366] hover:bg-[#25D366] hover:text-white transition-colors">
                                    <i class="fab fa-whatsapp"></i>
                                </a>
                            </div>
                        </div>
                        
                        <!-- Blog Text Content -->
                        <div class="prose prose-lg max-w-none">
                            {{ blog.content|safe|linebreaks }}
                        </div>
                        
                        <!-- Tags -->
                        {% if blog.tags %}
                        <div class="mt-8 pt-6 border-t border-gray-200">
                            <h3 class="text-lg font-semibold text-[#003366] mb-3">Tags</h3>
                            <div class="flex flex-wrap gap-2">
                                {% for tag in blog.tags.all %}
                                <span class="bg-[#003366]/10 text-[#003366] text-xs font-medium px-2.5 py-1.5 rounded-full">
                                    #{{ tag.name }}
                                </span>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                        
                        <!-- Navigation -->
                        <div class="mt-8 pt-6 border-t border-gray-200 flex justify-between">
                            {% if previous_blog %}
                            <a href="{% url 'wakeelapp:blogdetail' previous_blog.slug %}" class="flex items-center text-[#003366] hover:text-[#0066cc] transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                                </svg>
                                Previous Post
                            </a>
                            {% else %}
                            <div></div>
                            {% endif %}
                            
                            <a href="{% url 'wakeelapp:blogs' %}" class="px-4 py-2 bg-[#003366] text-white rounded-lg hover:bg-[#002244] transition-colors">
                                <i class="fas fa-th-large mr-2"></i> All Blogs
                            </a>
                            
                            {% if next_blog %}
                            <a href="{% url 'wakeelapp:blogdetail' next_blog.slug %}" class="flex items-center text-[#003366] hover:text-[#0066cc] transition-colors">
                                Next Post
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                            </a>
                            {% else %}
                            <div></div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Sidebar -->
            <div class="w-full lg:w-1/3">
                <div class="sticky top-24">
                    <!-- Related Posts -->
                    <div class="bg-white p-6 rounded-xl shadow-md border border-[#003366]/10 mb-6 fade-in" style="animation-delay: 0.2s;">
                        <h3 class="text-xl font-bold text-[#003366] mb-4">
                            <i class="fas fa-newspaper mr-2"></i> Related Posts
                        </h3>
                        
                        <div class="space-y-4">
                            {% for sideblog in blogs %}
                                {% if sideblog.id != blog.id %}
                                <div class="group">
                                    <a href="{% url 'wakeelapp:blogdetail' sideblog.slug %}" class="flex gap-4 p-3 rounded-lg hover:bg-[#003366]/5 transition-all duration-200">
                                        <div class="w-20 h-20 flex-shrink-0 rounded-lg overflow-hidden">
                                            <img src="{{ sideblog.image.url }}" alt="{{ sideblog.title }}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" />
                                        </div>
                                        <div class="flex-1">
                                            <h4 class="font-semibold text-[#003366] line-clamp-2 group-hover:text-[#0066cc] transition-colors">{{ sideblog.title }}</h4>
                                            <p class="text-gray-500 text-xs mt-1">
                                                <i class="far fa-calendar-alt mr-1"></i> {{ sideblog.created_at|date:"M d, Y" }}
                                            </p>
                                        </div>
                                    </a>
                                </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                    
                    <!-- Categories -->
                    <div class="bg-white p-6 rounded-xl shadow-md border border-[#003366]/10 mb-6 fade-in" style="animation-delay: 0.3s;">
                        <h3 class="text-xl font-bold text-[#003366] mb-4">
                            <i class="fas fa-tags mr-2"></i> Categories
                        </h3>
                        <div class="space-y-2">
                            {% for category in categories %}
                            <a href="{% url 'wakeelapp:blogs' %}?category={{ category.name }}" class="flex items-center p-3 rounded-lg hover:bg-[#003366]/5 transition-all duration-200">
                                <i class="fas fa-folder text-[#003366] mr-3"></i>
                                <span>{{ category.name }}</span>
                                <span class="ml-auto bg-[#003366]/10 text-[#003366] text-xs font-medium px-2.5 py-0.5 rounded-full">
                                    {{ category.blog_set.count }}
                                </span>
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <!-- Contact CTA -->
                    <div class="bg-gradient-to-r from-[#003366] to-[#0066cc] p-6 rounded-xl shadow-md mb-6 text-white fade-in" style="animation-delay: 0.4s;">
                        <h3 class="text-xl font-bold mb-3">
                            <i class="fas fa-question-circle mr-2"></i> Need Help?
                        </h3>
                        <p class="text-white/90 mb-4">
                            Have questions about our services or need personalized advice? Our team is ready to assist you.
                        </p>
                        <div class="flex flex-col space-y-2">
                            <a href="{% url 'wakeelapp:contact' %}" class="px-4 py-2 bg-white text-[#003366] font-semibold rounded-lg hover:bg-gray-100 transition-all duration-300 flex items-center justify-center">
                                <i class="fas fa-envelope mr-2"></i> Contact Us
                            </a>
                            <a href="https://wa.me/923369969997" class="px-4 py-2 bg-[#25D366] text-white font-semibold rounded-lg hover:bg-[#128C7E] transition-all duration-300 flex items-center justify-center">
                                <i class="fab fa-whatsapp mr-2"></i> WhatsApp
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Share post function
        window.sharePost = function(title, url) {
            if (navigator.share) {
                navigator.share({
                    title: title,
                    url: url
                })
                .then(() => console.log('Successful share'))
                .catch((error) => console.log('Error sharing:', error));
            } else {
                // Fallback for browsers that don't support Web Share API
                const tempInput = document.createElement('input');
                document.body.appendChild(tempInput);
                tempInput.value = url;
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                
                // Show a toast notification
                const toast = document.createElement('div');
                toast.className = 'fixed bottom-4 right-4 bg-[#003366] text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-fadeIn';
                toast.innerHTML = '<div class="flex items-center"><i class="fas fa-check-circle mr-2"></i> Link copied to clipboard</div>';
                document.body.appendChild(toast);
                
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transition = 'opacity 0.5s ease';
                    setTimeout(() => {
                        document.body.removeChild(toast);
                    }, 500);
                }, 3000);
            }
        };
        
        // Add animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    if (entry.target.classList.contains('slide-up')) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    } else if (entry.target.classList.contains('fade-in')) {
                        entry.target.style.opacity = '1';
                    }
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);
        
        document.querySelectorAll('.fade-in').forEach(el => {
          el.style.opacity = '0';
          el.style.transition = 'opacity 0.8s ease-in-out';
          observer.observe(el);
      });
      
      // Add smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
          anchor.addEventListener('click', function (e) {
              e.preventDefault();
              
              const targetId = this.getAttribute('href');
              const targetElement = document.querySelector(targetId);
              
              if (targetElement) {
                  window.scrollTo({
                      top: targetElement.offsetTop - 100,
                      behavior: 'smooth'
                  });
              }
          });
      });
      
      // Add reading progress indicator
      const progressBar = document.createElement('div');
      progressBar.className = 'fixed top-0 left-0 h-1 bg-[#003366] z-50 transition-all duration-300';
      progressBar.style.width = '0%';
      document.body.appendChild(progressBar);
      
      window.addEventListener('scroll', () => {
          const scrollTop = window.scrollY;
          const docHeight = document.documentElement.scrollHeight - window.innerHeight;
          const scrollPercent = (scrollTop / docHeight) * 100;
          progressBar.style.width = scrollPercent + '%';
      });
      
      // Add table of contents if there are headings
      const articleContent = document.querySelector('.prose');
      if (articleContent) {
          const headings = articleContent.querySelectorAll('h2, h3, h4');
          
          if (headings.length > 0) {
              // Create TOC container
              const tocContainer = document.createElement('div');
              tocContainer.className = 'bg-[#003366]/5 p-4 rounded-lg mb-6';
              tocContainer.innerHTML = '<h4 class="font-semibold text-[#003366] mb-2">Table of Contents</h4>';
              
              const tocList = document.createElement('ul');
              tocList.className = 'space-y-1 text-sm';
              
              // Add IDs to headings and create TOC items
              headings.forEach((heading, index) => {
                  const headingId = `heading-${index}`;
                  heading.id = headingId;
                  
                  const listItem = document.createElement('li');
                  const link = document.createElement('a');
                  link.href = `#${headingId}`;
                  link.className = 'text-[#003366] hover:text-[#0066cc] transition-colors';
                  link.textContent = heading.textContent;
                  
                  // Add indentation based on heading level
                  if (heading.tagName === 'H3') {
                      link.className += ' ml-4';
                  } else if (heading.tagName === 'H4') {
                      link.className += ' ml-8';
                  }
                  
                  listItem.appendChild(link);
                  tocList.appendChild(listItem);
              });
              
              tocContainer.appendChild(tocList);
              
              // Insert TOC after the first paragraph
              const firstParagraph = articleContent.querySelector('p');
              if (firstParagraph && headings.length > 2) {
                  firstParagraph.parentNode.insertBefore(tocContainer, firstParagraph.nextSibling);
              }
          }
      }
  });
  
  // Add animation styles
  document.head.insertAdjacentHTML('beforeend', `
      <style>
          @keyframes fadeIn {
              from { opacity: 0; transform: translateY(10px); }
              to { opacity: 1; transform: translateY(0); }
          }
          .animate-fadeIn {
              animation: fadeIn 0.5s ease-out forwards;
          }
          
          /* Line clamp utilities */
          .line-clamp-2 {
              display: -webkit-box;
              -webkit-line-clamp: 2;
              -webkit-box-orient: vertical;
              overflow: hidden;
          }
          
          /* Prose styling enhancements */
          .prose img {
              border-radius: 0.5rem;
              box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
          }
          
          .prose h2 {
              color: #003366;
              font-size: 1.5rem;
              margin-top: 2rem;
              margin-bottom: 1rem;
              font-weight: 700;
          }
          
          .prose h3 {
              color: #003366;
              font-size: 1.25rem;
              margin-top: 1.5rem;
              margin-bottom: 0.75rem;
              font-weight: 600;
          }
          
          .prose p {
              margin-bottom: 1rem;
              line-height: 1.7;
          }
          
          .prose a {
              color: #0066cc;
              text-decoration: none;
              transition: color 0.2s;
          }
          
          .prose a:hover {
              color: #003366;
              text-decoration: underline;
          }
          
          .prose blockquote {
              border-left: 4px solid #003366;
              padding-left: 1rem;
              font-style: italic;
              color: #4a5568;
              margin: 1.5rem 0;
          }
          
          .prose ul, .prose ol {
              padding-left: 1.5rem;
              margin: 1rem 0;
          }
          
          .prose li {
              margin-bottom: 0.5rem;
          }
          
          .prose table {
              width: 100%;
              border-collapse: collapse;
              margin: 1.5rem 0;
          }
          
          .prose th, .prose td {
              padding: 0.75rem;
              border: 1px solid #e2e8f0;
          }
          
          .prose th {
              background-color: #f7fafc;
              font-weight: 600;
          }
      </style>
  `);
</script>
{% endblock Content %}