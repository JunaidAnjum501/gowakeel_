{% extends "wakeelapp/zakatcalculator.html" %} {% load static %}
{% block title %}<title>ATL Status Finder - Check Active Taxpayer List Status | GoWakeel</title>{% endblock title %}
{% block metatitle %}<meta name="description" content="Check your ATL (Active Taxpayer List) status online. Verify if you're on the active taxpayer list and download information as PDF with GoWakeel's ATL Status Finder.">{% endblock metatitle %}

{% block Content %}
<section class="py-12 bg-gradient-to-r from-white to-[#003366]/5 dark:from-gray-900 dark:to-gray-800 transition-colors duration-300">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Page Header -->
    <div class="text-center mb-10">
      <h1 class="text-3xl md:text-4xl font-bold text-[#003366] dark:text-blue-300 mb-4 transition-colors duration-300">
        <i class="fas fa-check-circle mr-2"></i>ATL Status Finder
      </h1>
      <p class="text-gray-600 dark:text-gray-300 max-w-3xl mx-auto transition-colors duration-300">Check if you're on the Active Taxpayer List (ATL) instantly. Enter your CNIC or NTN number below to verify your tax filing status.</p>
    </div>

    <!-- Dark Mode Toggle -->
    <div class="absolute top-4 right-4 md:top-6 md:right-6">
      <button id="darkModeToggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300">
        <i class="fas fa-moon dark:hidden"></i>
        <i class="fas fa-sun hidden dark:inline"></i>
      </button>
    </div>

    <!-- Search Card -->
    <div class="max-w-xl mx-auto bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-[#003366]/10 dark:border-blue-900/30 mb-8 transition-colors duration-300">
      <h2 class="text-xl font-bold text-[#003366] dark:text-blue-300 mb-4 flex items-center transition-colors duration-300">
        <i class="fas fa-search mr-2"></i> Find ATL Status
      </h2>
      <div class="space-y-4">
        <div>
          <label for="cnicInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 transition-colors duration-300">CNIC/NTN Number</label>
          <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <i class="fas fa-id-card text-gray-400 dark:text-gray-500 transition-colors duration-300"></i>
            </div>
            <input
              id="cnicInput"
              type="text"
              placeholder="Enter 13-digit CNIC or 7-digit NTN"
              class="pl-10 w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-[#003366] dark:focus:ring-blue-500 focus:border-[#003366] dark:focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300"
              maxlength="13"
            />
          </div>
          <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 transition-colors duration-300">Example: 1110114913415 (CNIC) or 7238215 (NTN)</p>
        </div>
        
        <div class="flex space-x-2">
          <button
            onclick="searchCNIC()"
            class="flex-1 bg-gradient-to-r from-[#003366] to-[#0066cc] text-white py-3 rounded-lg hover:from-[#002244] hover:to-[#004c99] transition-all duration-300 flex items-center justify-center"
          >
            <i class="fas fa-search mr-2"></i> Check ATL Status
          </button>
          
          <button
            onclick="clearSearch()"
            class="px-4 py-3 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-all duration-300 flex items-center justify-center"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <!-- Recent Searches -->
        <div id="recentSearches" class="hidden mt-4">
          <p class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 transition-colors duration-300">Recent Searches:</p>
          <div id="recentSearchesList" class="flex flex-wrap gap-2">
            <!-- Recent searches will be added here dynamically -->
          </div>
        </div>
        
        <div id="errorMessage" class="hidden p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-lg text-center text-sm transition-colors duration-300"></div>
        <div id="loadingIndicator" class="hidden text-center">
          <div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-[#003366] dark:border-blue-400 transition-colors duration-300"></div>
          <p class="text-sm text-gray-600 dark:text-gray-400 mt-2 transition-colors duration-300">Searching...</p>
        </div>
      </div>
    </div>

    <!-- Result Card -->
    <div
      id="resultCard"
      class="max-w-3xl mx-auto bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg mt-6 hidden relative border border-[#003366]/10 dark:border-blue-900/30 transition-colors duration-300"
    >
      <!-- Close Button -->
      <button
        id="close"
        onclick="closeCard()"
        class="absolute top-4 right-4 w-8 h-8 flex items-center cursor-pointer justify-center rounded-full text-white font-bold bg-[#003366] hover:bg-[#002244] dark:bg-blue-600 dark:hover:bg-blue-700 transition-colors duration-300"
      >
        <i class="fas fa-times"></i>
      </button>

      <div class="text-center mb-6">
        <div class="inline-flex items-center justify-center w-16 h-16 bg-[#003366]/10 dark:bg-blue-900/30 rounded-full mb-4 transition-colors duration-300">
          <i class="fas fa-user-check text-[#003366] dark:text-blue-300 text-2xl transition-colors duration-300"></i>
        </div>
        <h2 class="text-2xl font-bold text-[#003366] dark:text-blue-300 transition-colors duration-300">ATL Status Details</h2>
        <p class="text-gray-500 dark:text-gray-400 transition-colors duration-300">Information retrieved from FBR database</p>
      </div>
      
      <div id="cardContent" class="mt-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-y-4 gap-x-8 text-gray-700 dark:text-gray-300 transition-colors duration-300">
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Registration No</p>
            <p id="regNo" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Reference No</p>
            <p id="refNo" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Name</p>
            <p id="name" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Category</p>
            <p id="category" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Registered for Sales Tax</p>
            <p id="salesTax" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">PP/REG/INC No</p>
            <p id="ppRegNo" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Email</p>
            <p id="email" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Cell</p>
            <p id="cell" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 col-span-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Address</p>
            <p id="address" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Registered On</p>
            <p id="regDate" class="font-medium"></p>
          </div>
          <div class="border-b dark:border-gray-700 pb-2 transition-colors duration-300">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Tax Office</p>
            <p id="taxOffice" class="font-medium"></p>
          </div>
          <div class="col-span-2 mt-2">
            <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">ATL Status</p>
            <p id="status" class="font-medium text-green-600 dark:text-green-400 transition-colors duration-300"></p>
          </div>
        </div>
      </div>

            <!-- Action Buttons -->
            <div class="mt-6 flex flex-col sm:flex-row justify-center gap-3">
              <button
                id="downloadPdf"
                onclick="downloadPDF()"
                class="px-6 py-3 bg-[#003366] dark:bg-blue-600 text-white rounded-lg hover:bg-[#002244] dark:hover:bg-blue-700 transition-all duration-300 flex items-center justify-center"
              >
                <i class="fas fa-file-pdf mr-2"></i> Download as PDF
              </button>
              
              <button
                onclick="saveSearch()"
                class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all duration-300 flex items-center justify-center"
              >
                <i class="fas fa-bookmark mr-2"></i> Save Result
              </button>
              
              <button
                onclick="shareResult()"
                class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300 flex items-center justify-center"
              >
                <i class="fas fa-share-alt mr-2"></i> Share
              </button>
              
              <button
                onclick="showMinResult()"
                class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-all duration-300 flex items-center justify-center"
              >
                <i class="fas fa-compress-alt mr-2"></i> Minimize
              </button>
            </div>
    </div>
    
    
           <!-- Minimal Result Card -->
    <div id="minResultCard" class="max-w-3xl mx-auto bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md mt-6 hidden relative border border-[#003366]/10 dark:border-blue-900/30 transition-colors duration-300">
      <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
        <div class="flex-1">
          <h3 id="minName" class="text-lg font-semibold text-[#003366] dark:text-blue-300 mb-1 transition-colors duration-300"></h3>
          <div class="flex flex-wrap gap-x-6 gap-y-2 text-sm">
            <p class="text-gray-600 dark:text-gray-400 transition-colors duration-300">
              <i class="fas fa-id-card mr-1 text-gray-500 dark:text-gray-500"></i> 
              <span id="minRegNo"></span>
            </p>
            <p class="flex items-center">
              <i class="fas fa-check-circle mr-1"></i>
              <span id="minStatus" class="font-medium"></span>
            </p>
          </div>
        </div>
        <div class="flex space-x-2 self-end sm:self-center">
          <button onclick="showFullResult()" class="px-4 py-2 bg-[#003366] dark:bg-blue-600 text-white rounded-lg hover:bg-[#002244] dark:hover:bg-blue-700 transition-all duration-300 flex items-center justify-center">
            <i class="fas fa-expand-alt mr-2"></i> View Details
          </button>
          <button onclick="closeMinCard()" class="p-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-300 transition-colors duration-300 bg-gray-100 dark:bg-gray-700 rounded-lg" title="Close">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      
      <!-- Quick Actions -->
      <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
        <div class="flex flex-wrap gap-2 justify-center">
          <button onclick="saveSearch()" class="px-3 py-1.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-300 flex items-center text-sm">
            <i class="fas fa-bookmark mr-1.5 text-green-600 dark:text-green-400"></i> Save
          </button>
          <button onclick="downloadPDF()" class="px-3 py-1.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-300 flex items-center text-sm">
            <i class="fas fa-file-pdf mr-1.5 text-red-600 dark:text-red-400"></i> PDF
          </button>
          <button onclick="shareResult()" class="px-3 py-1.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-300 flex items-center text-sm">
            <i class="fas fa-share-alt mr-1.5 text-blue-600 dark:text-blue-400"></i> Share
          </button>
        </div>
      </div>
    </div>

    <!-- Saved Results Section -->
    <div id="savedResultsSection" class="max-w-3xl mx-auto mt-8 hidden">
      <h3 class="text-xl font-bold text-[#003366] dark:text-blue-300 mb-4 transition-colors duration-300">
        <i class="fas fa-bookmark mr-2"></i> Saved Results
      </h3>
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md border border-[#003366]/10 dark:border-blue-900/30 overflow-hidden transition-colors duration-300">
        <div id="noSavedResults" class="p-6 text-center text-gray-500 dark:text-gray-400 transition-colors duration-300">
          <i class="fas fa-info-circle text-2xl mb-2"></i>
          <p>No saved results yet.</p>
        </div>
        <div id="savedResultsList" class="hidden divide-y divide-gray-200 dark:divide-gray-700 transition-colors duration-300">
          <!-- Saved results will be added here dynamically -->
        </div>
      </div>
    </div>

    <!-- Information Sections -->
    <div class="mt-16 grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Benefits Section -->
      <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-[#003366]/10 dark:border-blue-900/30 transition-colors duration-300">
        <h2 class="text-2xl font-bold text-[#003366] dark:text-blue-300 mb-4 flex items-center transition-colors duration-300">
          <i class="fas fa-check-circle mr-2 text-[#003366] dark:text-blue-300 transition-colors duration-300"></i> Benefits of being on ATL
        </h2>
        <ul class="space-y-3 text-gray-700 dark:text-gray-300 transition-colors duration-300">
          <li class="flex items-start">
            <i class="fas fa-check text-green-500 dark:text-green-400 mt-1 mr-2 transition-colors duration-300"></i>
            <span><strong>Lower Tax Rates:</strong> Active taxpayers enjoy reduced withholding tax rates on various transactions including banking, property, and vehicle purchases.</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-500 dark:text-green-400 mt-1 mr-2 transition-colors duration-300"></i>
            <span><strong>Business Credibility:</strong> Being on the ATL enhances your business reputation and credibility with partners and financial institutions.</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-500 dark:text-green-400 mt-1 mr-2 transition-colors duration-300"></i>
            <span><strong>Avoid Penalties:</strong> Non-filers face higher tax rates and may be subject to penalties from FBR for non-compliance.</span>
          </li>
          <li class="flex items-start">
            <i class="fas fa-check text-green-500 dark:text-green-400 mt-1 mr-2 transition-colors duration-300"></i>
            <span><strong>Financial Services:</strong> Many banks and financial institutions check ATL status before processing loans, credit cards, and other financial services.</span>
          </li>
        </ul>
      </div>
      
      <!-- How to Get on ATL Section -->
      <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md border border-[#003366]/10 dark:border-blue-900/30 transition-colors duration-300">
        <h2 class="text-2xl font-bold text-[#003366] dark:text-blue-300 mb-4 flex items-center transition-colors duration-300">
          <i class="fas fa-file-alt mr-2 text-[#003366] dark:text-blue-300 transition-colors duration-300"></i> How to Get on the ATL
        </h2>
        <ol class="space-y-3 text-gray-700 dark:text-gray-300 list-decimal pl-5 transition-colors duration-300">
          <li class="pl-2">
            <strong><i class="fas fa-id-card mr-1"></i> Get an NTN:</strong> Register for a National Tax Number if you don't already have one.
          </li>
          <li class="pl-2">
            <strong><i class="fas fa-file-invoice mr-1"></i> File Tax Return:</strong> Submit your income tax return for the relevant tax year before the deadline.
          </li>
          <li class="pl-2">
            <strong><i class="fas fa-money-bill-wave mr-1"></i> Pay Due Tax:</strong> Ensure all due taxes are paid as per your return calculation.
          </li>
          <li class="pl-2">
            <strong><i class="fas fa-calendar-check mr-1"></i> Annual Renewal:</strong> File your tax return annually to maintain your status on the ATL.
          </li>
          <li class="pl-2">
            <strong><i class="fas fa-check-double mr-1"></i> Verification:</strong> Your name will appear on the ATL after successful filing and verification.
          </li>
        </ol>
        <div class="mt-4">
          <a href="{% url 'wakeelapp:contact' %}" class="inline-flex items-center text-[#003366] dark:text-blue-300 hover:text-[#0066cc] dark:hover:text-blue-400 transition-colors duration-300">
            <i class="fas fa-headset mr-2"></i> Need help with tax filing? Contact our experts
            <i class="fas fa-arrow-right ml-2"></i>
          </a>
        </div>
      </div>
    </div>
    
    <!-- FAQ Section -->
    <div class="mt-12">
      <h2 class="text-2xl font-bold text-[#003366] dark:text-blue-300 mb-6 text-center transition-colors duration-300">
        <i class="fas fa-question-circle mr-2"></i>Frequently Asked Questions
      </h2>
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md border border-[#003366]/10 dark:border-blue-900/30 overflow-hidden transition-colors duration-300">
        <div class="divide-y divide-gray-200 dark:divide-gray-700 transition-colors duration-300">
          <div class="faq-item">
            <button class="faq-question w-full flex items-center justify-between p-6 text-left focus:outline-none">
              <span class="text-lg font-semibold text-[#003366] dark:text-blue-300 transition-colors duration-300"><i class="fas fa-info-circle mr-2"></i>What is the Active Taxpayer List (ATL)?</span>
              <i class="fas fa-chevron-down text-[#003366] dark:text-blue-300 transform transition-transform duration-300"></i>
            </button>
            <div class="faq-answer px-6 pb-6 hidden">
              <p class="text-gray-700 dark:text-gray-300 transition-colors duration-300">The Active Taxpayer List (ATL) is a database maintained by the Federal Board of Revenue (FBR) that contains the names of individuals and businesses who have filed their income tax returns for the current tax year. Being on the ATL indicates tax compliance and provides various benefits including lower withholding tax rates.</p>
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question w-full flex items-center justify-between p-6 text-left focus:outline-none">
              <span class="text-lg font-semibold text-[#003366] dark:text-blue-300 transition-colors duration-300"><i class="fas fa-calendar-alt mr-2"></i>How often is the ATL updated?</span>
              <i class="fas fa-chevron-down text-[#003366] dark:text-blue-300 transform transition-transform duration-300"></i>
            </button>
            <div class="faq-answer px-6 pb-6 hidden">
              <p class="text-gray-700 dark:text-gray-300 transition-colors duration-300">The FBR updates the ATL regularly. Generally, it's updated after the tax filing deadline for each tax year. However, if you file your return after the deadline, your name may be added to the ATL within a few days to weeks after filing and verification.</p>
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question w-full flex items-center justify-between p-6 text-left focus:outline-none">
              <span class="text-lg font-semibold text-[#003366] dark:text-blue-300 transition-colors duration-300"><i class="fas fa-exclamation-triangle mr-2"></i>What happens if I'm not on the ATL?</span>
              <i class="fas fa-chevron-down text-[#003366] dark:text-blue-300 transform transition-transform duration-300"></i>
            </button>
            <div class="faq-answer px-6 pb-6 hidden">
              <p class="text-gray-700 dark:text-gray-300 transition-colors duration-300">If you're not on the ATL, you'll be considered a "non-filer" and will be subject to higher withholding tax rates on various transactions such as banking, property, and vehicle purchases. Additionally, you may face difficulties in accessing certain financial services and could be subject to penalties from the FBR.</p>
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question w-full flex items-center justify-between p-6 text-left focus:outline-none">
              <span class="text-lg font-semibold text-[#003366] dark:text-blue-300 transition-colors duration-300"><i class="fas fa-sync-alt mr-2"></i>How can I check my ATL status?</span>
              <i class="fas fa-chevron-down text-[#003366] dark:text-blue-300 transform transition-transform duration-300"></i>
            </button>
            <div class="faq-answer px-6 pb-6 hidden">
              <p class="text-gray-700 dark:text-gray-300 transition-colors duration-300">You can check your ATL status by entering your CNIC or NTN number in the search box above. Alternatively, you can visit the FBR's official website or use the FBR Tax Asaan mobile app. Our tool provides a convenient way to check your status and download the information as a PDF.</p>
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question w-full flex items-center justify-between p-6 text-left focus:outline-none">
              <span class="text-lg font-semibold text-[#003366] dark:text-blue-300 transition-colors duration-300"><i class="fas fa-file-alt mr-2"></i>Can I file my tax return after the deadline?</span>
              <i class="fas fa-chevron-down text-[#003366] dark:text-blue-300 transform transition-transform duration-300"></i>
            </button>
            <div class="faq-answer px-6 pb-6 hidden">
              <p class="text-gray-700 dark:text-gray-300 transition-colors duration-300">Yes, you can file your tax return after the deadline, but you may be subject to penalties for late filing. However, once you file your return and it's verified, your name will be added to the ATL, and you'll start enjoying the benefits of being an active taxpayer.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Call to Action Section -->
    <div class="mt-16 bg-[#003366] dark:bg-blue-900 rounded-xl p-8 text-center transition-colors duration-300">
      <h2 class="text-2xl font-bold text-white mb-4 transition-colors duration-300">
        <i class="fas fa-hand-point-right mr-2"></i>Need Professional Assistance?
      </h2>
      <p class="text-white/80 max-w-2xl mx-auto mb-6 transition-colors duration-300">Our tax experts can help you with tax filing, ATL verification, and other tax-related services.</p>
      <div class="flex flex-col sm:flex-row justify-center gap-4">
        <a href="{% url 'wakeelapp:contact' %}" class="px-6 py-3 bg-white text-[#003366] font-semibold rounded-lg hover:bg-gray-100 transition-all duration-300 flex items-center justify-center">
          <i class="fas fa-envelope mr-2"></i> Contact Us
        </a>
        <a href="https://wa.me/923369969997?text=I'm%20interested%20in%20tax%20filing%20services" class="px-6 py-3 bg-[#25D366] text-white font-semibold rounded-lg hover:bg-[#128C7E] transition-all duration-300 flex items-center justify-center">
          <i class="fab fa-whatsapp mr-2"></i> WhatsApp Us
        </a>
      </div>
    </div>
  </div>
</section>

<!-- Share Modal -->
<div id="shareModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
  <div class="bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full mx-4 transition-colors duration-300">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-bold text-[#003366] dark:text-blue-300 transition-colors duration-300">Share ATL Information</h3>
      <button onclick="closeShareModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors duration-300">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="space-y-4">
      <p class="text-gray-700 dark:text-gray-300 text-sm transition-colors duration-300">Share this ATL information via:</p>
      <div class="grid grid-cols-2 gap-3">
        <button onclick="copyShareLink()" class="flex items-center justify-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-300">
          <i class="fas fa-link text-gray-700 dark:text-gray-300 mr-2 transition-colors duration-300"></i>
          <span class="text-gray-700 dark:text-gray-300 transition-colors duration-300">Copy Link</span>
        </button>
        <button onclick="shareWhatsApp()" class="flex items-center justify-center p-3 bg-[#25D366] rounded-lg hover:bg-[#128C7E] transition-colors duration-300">
          <i class="fab fa-whatsapp text-white mr-2"></i>
          <span class="text-white">WhatsApp</span>
        </button>
        <button onclick="shareEmail()" class="flex items-center justify-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-300">
          <i class="fas fa-envelope text-gray-700 dark:text-gray-300 mr-2 transition-colors duration-300"></i>
          <span class="text-gray-700 dark:text-gray-300 transition-colors duration-300">Email</span>
        </button>
        <button onclick="shareSMS()" class="flex items-center justify-center p-3 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-300">
          <i class="fas fa-sms text-gray-700 dark:text-gray-300 mr-2 transition-colors duration-300"></i>
          <span class="text-gray-700 dark:text-gray-300 transition-colors duration-300">SMS</span>
        </button>
      </div>
      <div id="shareLinkCopied" class="hidden mt-2 p-2 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-sm rounded text-center transition-colors duration-300">
        Link copied to clipboard!
      </div>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
  // Sample Data
  const userData = {
    1110114913415: {
      "Registration No": "1110114913415",
      "Reference No": "7238215-1",
      "Registered for Sales Tax": "No",
      Name: "MUHAMMAD ANWAR BAZKHAN",
      Category: "Pakistani Male",
      "PP/REG/INC No": "1110114913415",
      Email: "anw****z@***l.com",
      Cell: "00923**973**30",
      Address:
      "69V2, Street No 8, Khayaban e Badban, DHA Phase 5, Karachi South Saddar Town",
      "Registered On": "01-JUN-2016",
      "Tax Office": "RTO-II KARACHI",
      "Registration Status": "Active Taxpayer: Yes",
    },
    3520256501234: {
      "Registration No": "3520256501234",
      "Reference No": "8456123-2",
      "Registered for Sales Tax": "Yes",
      Name: "AHMED KHAN MALIK",
      Category: "Pakistani Male",
      "PP/REG/INC No": "3520256501234",
      Email: "ahm****ik@***l.com",
      Cell: "00923**456**78",
      Address:
        "House 123, Block B, Gulberg III, Lahore",
      "Registered On": "15-MAR-2019",
      "Tax Office": "RTO LAHORE",
      "Registration Status": "Active Taxpayer: Yes",
    },
    4210167890123: {
      "Registration No": "4210167890123",
      "Reference No": "9876543-3",
      "Registered for Sales Tax": "Yes",
      Name: "FATIMA ZAHRA",
      Category: "Pakistani Female",
      "PP/REG/INC No": "4210167890123",
      Email: "fat****ra@***l.com",
      Cell: "00923**789**45",
      Address:
        "Flat 405, Al-Habib Heights, Block 9, Clifton, Karachi",
      "Registered On": "22-SEP-2020",
      "Tax Office": "RTO-III KARACHI",
      "Registration Status": "Active Taxpayer: Yes",
    },
    7238215: {
      "Registration No": "7238215",
      "Reference No": "7238215-1",
      "Registered for Sales Tax": "Yes",
      Name: "MUHAMMAD ANWAR BAZKHAN",
      Category: "Pakistani Male",
      "PP/REG/INC No": "1110114913415",
      Email: "anw****z@***l.com",
      Cell: "00923**973**30",
      Address:
        "69V2, Street No 8, Khayaban e Badban, DHA Phase 5, Karachi South Saddar Town",
      "Registered On": "01-JUN-2016",
      "Tax Office": "RTO-II KARACHI",
      "Registration Status": "Active Taxpayer: Yes",
    },
    8456123: {
      "Registration No": "8456123",
      "Reference No": "8456123-2",
      "Registered for Sales Tax": "No",
      Name: "AHMED KHAN MALIK",
      Category: "Pakistani Male",
      "PP/REG/INC No": "3520256501234",
      Email: "ahm****ik@***l.com",
      Cell: "00923**456**78",
      Address:
        "House 123, Block B, Gulberg III, Lahore",
      "Registered On": "15-MAR-2019",
      "Tax Office": "RTO LAHORE",
      "Registration Status": "Active Taxpayer: No",
    }
  };

  // Initialize dark mode
  document.addEventListener('DOMContentLoaded', function() {
    initDarkMode();
    initFAQAccordion();
    loadRecentSearches();
    loadSavedResults();
  });

  // Dark mode functionality
  function initDarkMode() {
    const darkModeToggle = document.getElementById('darkModeToggle');
    
    // Check for saved theme preference or use system preference
    const savedTheme = localStorage.getItem('theme');
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    
    // Apply the right theme
    if (savedTheme === 'dark' || (!savedTheme && systemPrefersDark)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
    
    // Toggle dark/light mode
    darkModeToggle.addEventListener('click', function() {
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      }
    });
  }

  // Initialize FAQ accordion
  function initFAQAccordion() {
    const faqQuestions = document.querySelectorAll('.faq-question');
    
    faqQuestions.forEach(question => {
      question.addEventListener('click', () => {
        const answer = question.nextElementSibling;
        const icon = question.querySelector('i.fa-chevron-down');
        
        // Toggle answer visibility
        if (answer.classList.contains('hidden')) {
          answer.classList.remove('hidden');
          icon.classList.add('rotate-180');
        } else {
          answer.classList.add('hidden');
          icon.classList.remove('rotate-180');
        }
      });
    });
  }

  // Function to search CNIC or NTN
  function searchCNIC() {
    const cnicInput = document.getElementById("cnicInput").value.trim();
    const errorMessage = document.getElementById("errorMessage");
    const loadingIndicator = document.getElementById("loadingIndicator");
    const resultCard = document.getElementById("resultCard");
    
    // Reset UI
    errorMessage.classList.add("hidden");
    resultCard.classList.add("hidden");
    
    // Validate input
    if (!cnicInput) {
      showError("Please enter a CNIC or NTN number");
      return;
    }
    
    if (!/^\d{7,13}$/.test(cnicInput)) {
      showError("Please enter a valid 13-digit CNIC or 7-digit NTN number without dashes");
      return;
    }
    
    // Show loading
    loadingIndicator.classList.remove("hidden");
    
    // Simulate API call with timeout
    setTimeout(() => {
      loadingIndicator.classList.add("hidden");
      
      if (userData[cnicInput]) {
        displayResult(userData[cnicInput]);
        addToRecentSearches(cnicInput);
      } else {
        showError("No ATL record found for this CNIC/NTN. Please verify your number or contact FBR for assistance.");
      }
    }, 1500);
  }
  
  // Function to display error
  function showError(message) {
    const errorMessage = document.getElementById("errorMessage");
    errorMessage.textContent = message;
    errorMessage.classList.remove("hidden");
  }
  
  // Function to display result
    // Function to display result
    function displayResult(data) {
      // Populate fields
      document.getElementById("regNo").textContent = data["Registration No"];
      document.getElementById("refNo").textContent = data["Reference No"];
      document.getElementById("name").textContent = data["Name"];
      document.getElementById("category").textContent = data["Category"];
      document.getElementById("salesTax").textContent = data["Registered for Sales Tax"];
      document.getElementById("ppRegNo").textContent = data["PP/REG/INC No"];
      document.getElementById("email").textContent = data["Email"];
      document.getElementById("cell").textContent = data["Cell"];
      document.getElementById("address").textContent = data["Address"];
      document.getElementById("regDate").textContent = data["Registered On"];
      document.getElementById("taxOffice").textContent = data["Tax Office"];
      document.getElementById("status").textContent = data["Registration Status"];
      
      // Apply color based on status
      const statusElement = document.getElementById("status");
      if (data["Registration Status"].includes("Yes")) {
        statusElement.classList.remove("text-red-600", "dark:text-red-400");
        statusElement.classList.add("text-green-600", "dark:text-green-400");
      } else {
        statusElement.classList.remove("text-green-600", "dark:text-green-400");
        statusElement.classList.add("text-red-600", "dark:text-red-400");
      }
      
      // Show minimal result first instead of full result
      showMinResult();
    }
  
    // Function to close result card
    function closeCard() {
      document.getElementById("resultCard").classList.add("hidden");
      document.getElementById("minResultCard").classList.add("hidden");
      document.getElementById("cnicInput").focus();
    }
  
  // Function to clear search
  function clearSearch() {
    document.getElementById("cnicInput").value = "";
    document.getElementById("errorMessage").classList.add("hidden");
    document.getElementById("resultCard").classList.add("hidden");
    document.getElementById("cnicInput").focus();
  }
  
  // Function to add to recent searches
  function addToRecentSearches(cnic) {
    // Get existing searches
    let recentSearches = JSON.parse(localStorage.getItem('recentATLSearches')) || [];
    
    // Remove if already exists
    recentSearches = recentSearches.filter(item => item !== cnic);
    
    // Add to beginning of array
    recentSearches.unshift(cnic);
    
    // Keep only the last 5 searches
    if (recentSearches.length > 5) {
      recentSearches = recentSearches.slice(0, 5);
    }
    
    // Save to localStorage
    localStorage.setItem('recentATLSearches', JSON.stringify(recentSearches));
    
    // Update UI
    loadRecentSearches();
  }
  
  // Function to load recent searches
  function loadRecentSearches() {
    const recentSearches = JSON.parse(localStorage.getItem('recentATLSearches')) || [];
    const recentSearchesContainer = document.getElementById('recentSearches');
    const recentSearchesList = document.getElementById('recentSearchesList');
    
    if (recentSearches.length > 0) {
      recentSearchesList.innerHTML = '';
      recentSearches.forEach(cnic => {
        const button = document.createElement('button');
        button.className = 'px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 text-sm transition-colors duration-300';
        button.textContent = cnic.length === 13 ? formatCNIC(cnic) : cnic;
        button.onclick = function() {
          document.getElementById('cnicInput').value = cnic;
          searchCNIC();
        };
        recentSearchesList.appendChild(button);
      });
      recentSearchesContainer.classList.remove('hidden');
    } else {
      recentSearchesContainer.classList.add('hidden');
    }
  }
  
  // Format CNIC for display
  function formatCNIC(cnic) {
    return cnic.replace(/^(\d{5})(\d{7})(\d{1})$/, "$1-$2-$3");
  }
  
  // Function to save search result
  function saveSearch() {
    const cnic = document.getElementById("regNo").textContent;
    const name = document.getElementById("name").textContent;
    
    if (!cnic) {
      return;
    }
    
    // Get current data
    const data = {
      id: Date.now(),
      cnic: cnic,
      name: name,
      date: new Date().toLocaleDateString(),
      status: document.getElementById("status").textContent
    };
    
    // Get existing saved results
    let savedResults = JSON.parse(localStorage.getItem('savedATLResults')) || [];
    
    // Check if already saved
    const alreadySaved = savedResults.some(result => result.cnic === cnic);
    if (alreadySaved) {
      alert('This ATL record is already saved.');
      return;
    }
    
    // Add to saved results
    savedResults.push(data);
    
    // Save to localStorage
    localStorage.setItem('savedATLResults', JSON.stringify(savedResults));
    
    // Update UI
    loadSavedResults();
    
    // Show saved results section
    document.getElementById("savedResultsSection").classList.remove("hidden");
    
    // Show notification
    alert('ATL record saved successfully!');
  }
  
  // Function to load saved results
  function loadSavedResults() {
    const savedResults = JSON.parse(localStorage.getItem('savedATLResults')) || [];
    const noSavedResults = document.getElementById('noSavedResults');
    const savedResultsList = document.getElementById('savedResultsList');
    const savedResultsSection = document.getElementById('savedResultsSection');
    
    if (savedResults.length > 0) {
      savedResultsSection.classList.remove('hidden');
      noSavedResults.classList.add('hidden');
      savedResultsList.classList.remove('hidden');
      
      // Clear existing list
      savedResultsList.innerHTML = '';
      
      // Add each saved result
      savedResults.forEach(result => {
        const item = document.createElement('div');
        item.className = 'p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-300';
        
        // Determine status color
        const statusClass = result.status.includes("Yes") ? 
          "bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400" : 
          "bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400";
        
        item.innerHTML = `
          <div class="flex justify-between items-center">
            <div>
              <h4 class="font-medium text-gray-800 dark:text-gray-200 transition-colors duration-300">${result.name}</h4>
              <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">ID: ${result.cnic.length === 13 ? formatCNIC(result.cnic) : result.cnic}</p>
              <p class="text-sm text-gray-500 dark:text-gray-400 transition-colors duration-300">Saved on: ${result.date}</p>
              <span class="inline-block mt-1 px-2 py-1 text-xs rounded-full ${statusClass} transition-colors duration-300">${result.status}</span>
            </div>
            <div class="flex space-x-2">
              <button onclick="loadSavedResult('${result.cnic}')" class="p-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors duration-300">
                <i class="fas fa-eye"></i>
              </button>
              <button onclick="deleteSavedResult(${result.id})" class="p-2 text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 transition-colors duration-300">
                <i class="fas fa-trash-alt"></i>
              </button>
            </div>
          </div>
        `;
        savedResultsList.appendChild(item);
      });
    } else {
      if (savedResultsSection.classList.contains('hidden')) {
        savedResultsSection.classList.add('hidden');
      } else {
        noSavedResults.classList.remove('hidden');
        savedResultsList.classList.add('hidden');
      }
    }
  }
  
  // Function to load a saved result
  function loadSavedResult(cnic) {
    document.getElementById('cnicInput').value = cnic;
    searchCNIC();
  }
  
  // Function to delete a saved result
  function deleteSavedResult(id) {
    if (confirm('Are you sure you want to delete this saved record?')) {
      // Get existing saved results
      let savedResults = JSON.parse(localStorage.getItem('savedATLResults')) || [];
      
      // Filter out the one to delete
      savedResults = savedResults.filter(result => result.id !== id);
      
      // Save back to localStorage
      localStorage.setItem('savedATLResults', JSON.stringify(savedResults));
      
      // Update UI
      loadSavedResults();
    }
  }
  
  // Function to download PDF
  function downloadPDF() {
    // Get data from displayed result
    const name = document.getElementById("name").textContent;
    const regNo = document.getElementById("regNo").textContent;
    const status = document.getElementById("status").textContent;
    
    // Create a new window for PDF
    const printWindow = window.open('', '', 'height=650,width=900');
    printWindow.document.write('<html><head><title>ATL Certificate</title>');
    
    // Add styles
    printWindow.document.write(`
      <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
        .certificate { max-width: 800px; margin: 0 auto; border: 2px solid #003366; padding: 30px; }
        .header { text-align: center; margin-bottom: 30px; }
        .logo { font-size: 24px; font-weight: bold; color: #003366; margin-bottom: 10px; }
        h1 { color: #003366; margin-bottom: 20px; }
        .content { margin-bottom: 30px; }
        .info-row { display: flex; margin-bottom: 10px; }
        .label { font-weight: bold; width: 200px; }
        .value { flex: 1; }
        .footer { margin-top: 50px; text-align: center; font-size: 12px; color: #666; }
        .status { margin-top: 20px; padding: 10px; border-radius: 5px; font-weight: bold; text-align: center; }
        .status-active { background-color: #e6f7e6; color: #2e7d32; }
        .status-inactive { background-color: #ffebee; color: #c62828; }
        @media print {
          body { -webkit-print-color-adjust: exact; }
        }
      </style>
    `);
    
    printWindow.document.write('</head><body>');
    
    // Determine status class
    const statusClass = status.includes("Yes") ? "status-active" : "status-inactive";
    
    // Certificate content
    printWindow.document.write(`
      <div class="certificate">
        <div class="header">
          <div class="logo">GoWakeel</div>
          <h1>Active Taxpayer List (ATL) Certificate</h1>
          <p>This document confirms the ATL status as retrieved from FBR database</p>
        </div>
        
        <div class="content">
          <div class="info-row">
            <div class="label">Name:</div>
            <div class="value">${document.getElementById("name").textContent}</div>
          </div>
          <div class="info-row">
            <div class="label">Registration No:</div>
            <div class="value">${document.getElementById("regNo").textContent}</div>
          </div>
          <div class="info-row">
            <div class="label">Reference No:</div>
            <div class="value">${document.getElementById("refNo").textContent}</div>
          </div>
          <div class="info-row">
            <div class="label">Category:</div>
            <div class="value">${document.getElementById("category").textContent}</div>
          </div>
          <div class="info-row">
            <div class="label">Registered for Sales Tax:</div>
            <div class="value">${document.getElementById("salesTax").textContent}</div>
          </div>
          <div class="info-row">
            <div class="label">Address:</div>
            <div class="value">${document.getElementById("address").textContent}</div>
          </div>
          <div class="info-row">
            <div class="label">Registered On:</div>
            <div class="value">${document.getElementById("regDate").textContent}</div>
          </div>
          <div class="info-row">
            <div class="label">Tax Office:</div>
            <div class="value">${document.getElementById("taxOffice").textContent}</div>
          </div>
          
          <div class="status ${statusClass}">
            ${document.getElementById("status").textContent}
          </div>
        </div>
        
        <div class="footer">
          <p>This certificate was generated on ${new Date().toLocaleDateString()} using GoWakeel ATL Status Finder</p>
          <p>For verification, please visit the FBR official website or contact your nearest tax office.</p>
        </div>
      </div>
    `);
    
    printWindow.document.write('</body></html>');
    printWindow.document.close();
    
    // Wait for content to load then print
    printWindow.onload = function() {
      printWindow.focus();
      printWindow.print();
      printWindow.close();
    };
  }
  
  // Share functionality
  function shareResult() {
    document.getElementById('shareModal').classList.remove('hidden');
  }
  
  function closeShareModal() {
    document.getElementById('shareModal').classList.add('hidden');
    document.getElementById('shareLinkCopied').classList.add('hidden');
  }
  
  function copyShareLink() {
    const name = document.getElementById("name").textContent;
    const regNo = document.getElementById("regNo").textContent;
    const status = document.getElementById("status").textContent;
    
    // Create share text
    const shareText = `ATL Information for ${name} (${regNo}): ${status}. Check more details at GoWakeel ATL Status Finder.`;
    
    // Copy to clipboard
    navigator.clipboard.writeText(shareText).then(() => {
      document.getElementById('shareLinkCopied').classList.remove('hidden');
      setTimeout(() => {
        document.getElementById('shareLinkCopied').classList.add('hidden');
      }, 3000);
    });
  }
  
  function shareWhatsApp() {
    const name = document.getElementById("name").textContent;
    const regNo = document.getElementById("regNo").textContent;
    const status = document.getElementById("status").textContent;
    
    const shareText = `ATL Information for ${name} (${regNo}): ${status}. Check more details at GoWakeel ATL Status Finder.`;
    const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;
    
    window.open(whatsappUrl, '_blank');
  }
  
  function shareEmail() {
    const name = document.getElementById("name").textContent;
    const regNo = document.getElementById("regNo").textContent;
    const status = document.getElementById("status").textContent;
    
    const subject = `ATL Information for ${name}`;
    const body = `ATL Information for ${name} (${regNo}):\n\nATL Status: ${status}\n\nCheck more details at GoWakeel ATL Status Finder.`;
    
    window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  }
  
    function shareSMS() {
    const name = document.getElementById("name").textContent;
    const regNo = document.getElementById("regNo").textContent;
    const status = document.getElementById("status").textContent;
    
    const smsText = `ATL Information for ${name} (${regNo}): ${status}. Check more details at GoWakeel ATL Status Finder.`;
    
    window.location.href = `sms:?body=${encodeURIComponent(smsText)}`;
  }
  
      // Function to show minimal result
  function showMinResult() {
    const resultCard = document.getElementById("resultCard");
    const minResultCard = document.getElementById("minResultCard");
    
    // Get essential data
    const name = document.getElementById("name").textContent;
    const regNo = document.getElementById("regNo").textContent;
    const status = document.getElementById("status").textContent;
    
    // Populate minimal result card
    document.getElementById("minName").textContent = name;
    document.getElementById("minRegNo").textContent = regNo.length === 13 ? formatCNIC(regNo) : regNo;
    document.getElementById("minStatus").textContent = status;
    
    // Apply status color
    const minStatusElement = document.getElementById("minStatus");
    if (status.includes("Yes")) {
      minStatusElement.classList.remove("text-red-600", "dark:text-red-400");
      minStatusElement.classList.add("text-green-600", "dark:text-green-400");
      minStatusElement.previousElementSibling.classList.add("text-green-600", "dark:text-green-400");
    } else {
      minStatusElement.classList.remove("text-green-600", "dark:text-green-400");
      minStatusElement.classList.add("text-red-600", "dark:text-red-400");
      minStatusElement.previousElementSibling.classList.add("text-red-600", "dark:text-red-400");
    }
    
    // Hide full result, show minimal result
    resultCard.classList.add("hidden");
    minResultCard.classList.remove("hidden");
    
    // Scroll to minimal result
    minResultCard.scrollIntoView({ behavior: "smooth", block: "start" });
  }
  
  // Function to show full result
  function showFullResult() {
    const resultCard = document.getElementById("resultCard");
    const minResultCard = document.getElementById("minResultCard");
    
    // Hide minimal result, show full result
    minResultCard.classList.add("hidden");
    resultCard.classList.remove("hidden");
    
    // Scroll to result
    resultCard.scrollIntoView({ behavior: "smooth", block: "start" });
  }
  
  // Function to close minimal result card
  function closeMinCard() {
    document.getElementById("minResultCard").classList.add("hidden");
    document.getElementById("cnicInput").focus();
  }
</script>
{% endblock Content %}